# 面试

## 自我介绍

面试官好，我叫俞文健，上一家公司是在武汉和奇科技，从事了两年的前端开发工作，主要技术栈是 Vue2 Vue3。最近一个项目是一个物业管理系统，我主要负责基础数据管理、停车管理、安防管理、登录和权限管理这几个模块，同时还负责了通用组件和 hooks 的封装。

## 项目介绍

### 简单介绍

我最近做的是一个小区的智能管理项目，主要实现小区的安防管理和给住户提供一些便利。我主要负责的模块有基础数据管理、安防管理、停车管理、还有登录和权限管理这几个模块。

基础数据管理主要有住户信息，包括楼栋、单元、家庭成员，有物业信息，包括物业报修、通知公告、投诉建议，还有有生活缴费，包括物业管理费、停车费等。

停车管理就包括车辆登记、登记审核、停车费管理、车辆进出记录，按照车主的详细信息，包括车牌号，是私人车位还是月租，还要上传车位产权凭证、行驶证，来登记车辆信息。然后后台人员看到车辆详细信息，来审核通过或者驳回。

安防管理要配合一些硬件设施来完成。

### 二次封装请求

携带请求前缀；

设置请求拦截器，携带 token；

设置响应拦截器，处理请求结果：失败的回调中提示请求失败的原因；成功的回调中提示功能失败的原因或返回数据。

```js
import axios from "axios"
import { ElMessage } from "element-plus"
import { useUserInfoStore } from "@/stores/userInfo"


// 功能失败的错误原因
export const authErrMessage = {
  10031: "登录失效，请重新登录",
  10032: "您太久没登录，请重新登录",
  10033: "账户未绑定角色，请联系管理员绑定角色",
  10034: "该用户未注册，请联系管理员注册用户",
  10035: "code 无法获取对应第三方平台用户",
  10036: "该账户未关联员工，请联系管理员做关联",
  10037: "账号已无效",
  10038: "账号未找到"
}

// 请求失败的错误原因
export const networkErrMessage = {
  400: "错误的请求",
  401: "未授权，请重新登录",
  403: "拒绝访问",
  404: "未找到该资源",
  405: "请求方法未允许",
  408: "请求超时",
  500: "服务器端出错",
  502: "网络错误",
  503: "服务不可用",
  504: "网络超时",
  505: "http 版本不支持该请求"
}

const request = axios.create({
  // 携带请求前缀
  baseURL: import.meta.env.VITE_API_URL,
  timeout: 50000
})

request.interceptors.request.use(
  config => {
    // 携带 token
    config.headers["token"] = useUserInfoStore().token
    
    return config
  }
)

request.interceptors.response.use(
  response => {
    const { code, data, message } = response.data
    
    if (code !== 20000 && code !== 200) {
      const errorMessage = authErrMessage[code] || message || "Error"
      
      // 提示功能失败的原因
      ElMessage.error(errorMessage)
      
      if (code === 10031 || code === 10032) {
        // 清空用户信息
        useUserInfoStore().reset()
        
        // 去登录页
        window.location.href = "/"
      }
      
      return Promise.reject(errorMessage)
    }
    else {
      return data
    }
  },
  error => {
    if (error.response) {
      ElMessage.error(networkErrMessage[error.response.status])
    }
    else {
      if (error.message.indexOf("timeout") !== -1) {
        ElMessage.error("网络超时")
      }
      else if (error.message.indexOf("Network") !== -1) {
        ElMessage.error("网络连接错误")
      }
      else if (error.message.indexOf("canceled") !== -1) {
        ElMessage.error("请求取消了")
      }
      
      return Promise.reject(error)
    }
  }
)

export default request
```

### 取消重复请求



### 取消上一页请求



### 无感刷新



### 权限管理



### 虚拟列表



### 封装的组件



### 封装的 hooks



### 介绍 VueUse



### 项目优化