<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Document</title>
    <script src="https://unpkg.com/redux@4.2.0/dist/redux.js"></script>
    <!-- <script src="https://cdn.bootcdn.net/ajax/libs/vue/2.7.9/vue.js"></script> -->
  </head>
  <body>
    <p>
      <span id="span">1</span>
      <span id="span2"></span>
    </p>
    <div>
      <button id="incrementBtn">increment</button>
      <button id="decrementBtn">decrement</button>
    </div>

    <script>
      // 1. 创建 reducer 整合函数, 根据指令操作数据
      function countReducer(
        state = { value: 1, name: "s" } /* initState */,
        action
      ) {
        switch (action.type) {
          case "count/increment":
            return { ...state, value: state.value + action.payload }
          case "count/decrement":
            return { ...state, value: state.value - action.payload }
          default:
            return state
        }
      }

      const reducers = Redux.combineReducers({
        count: countReducer
      })

      // 2. 通过 reducer 对象创建 store
      const store = Redux.createStore(reducers)

      // 3. 订阅 store 的更新
      store.subscribe(() => {
        console.log(store.getState())
        // ReactDOM.createRoot(app).render(<App />)
        span.innerText = store.getState().count.value
        span2.innerText = store.getState().count.name
      })

      // 4. 通过 dispatch 派发 action 指令
      incrementBtn.addEventListener("click", () => {
        store.dispatch({ type: "increment", payload: 1 })
      })

      decrementBtn.addEventListener("click", () => {
        store.dispatch({ type: "decrement", payload: 1 })
      })
    </script>
  </body>
</html>
