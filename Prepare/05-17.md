## 三次握手

- 在发送数据前，通信双方必须在彼此间建立一条连接，三次握手就是在建立连接时发送的 3 次数据包

- 三次握手的意义在于，确保通信双方都能确定对方的接收和发送能力都正常

1. 客户端向服务端发送一个 SYN (请求) 数据包，请求建立连接

2. 服务器接收到 SYN 数据包，确认客户端发送能力正常，然后向客户端发送 SYN + ACK (应答) 数据包

3. 客户端接收到 SYN + ACK 数据包，确认服务器接收与发送能力正常，然后向服务器发送 ack 数据包

4. 服务器接收到 ACK 数据包，确认客户端接收能力正常

## 四次挥手

- TCP 断开连接需要发送四个数据包，因此称为四次挥手

- TCP 是双向的，所以需要在两个方向分别关闭，每个方向的关闭又需要请求和确认，所以一共就 4 次

- 客户端请求断开连接时，服务器只能应答，必须等待所有数据处理完毕，才能发送断开请求

1. 客户端向服务器发送 FIN (释放连接) 字段请求断开连接

2. 服务器向客户端发送 ACK 字段表示接收到断开连接请求

3. 服务器等待数据处理完毕，向客户端发送 FIN 字段请求断开连接

4. 客户端向服务器发送 ACK 字段表示接收到断开连接请求



在浏览器中输入地址并按下回车之后发生了什么？

```
1. 进行 DNS 解析，通过域名查询真实的 ip 地址

2. 浏览器和服务器通过三次握手建立 tcp/ip 连接

3. 浏览器向服务器发送 http 请求

4. 服务器处理请求，并返回响应报文

5. 浏览器将根据响应数据渲染页面

6. 浏览器和服务器通过四次挥手断开 tcp/ip 连接
```

三次握手(建立 tcp/ip 连接)？

```
1. 客户端向服务器发送请求(SYN)，申请建立连接

2. 服务器收到请求(SYN)，并向客户端返回数据(ACK)，申请建立连接

3. 客户端向服务器发送请求(ACK)，同意建立连接
```

四次挥手(断开 tcp/ip 连接)？

```
1. 客户端向服务器发送请求(FIN)，通知服务器数据发送完毕，申请断开连接

2. 服务器收到请求，并向客户端返回数据(ACK)

3. 服务器向客户端返回数据(FIN ACK)，通知客户端数据接收完毕，可以断开连接

4. 客户端向服务器发送数据(ACK)，同意断开连接
```
